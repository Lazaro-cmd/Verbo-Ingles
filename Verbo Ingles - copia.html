<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Verbo Ingl√©s ¬∑ Canvas</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{ --bg:#0b0f14; --card:#111826; --muted:#9aa4b2; --fg:#e5eef7; --brand:#4f8cff; --brand-2:#22d3ee; --ok:#10b981; --warn:#f59e0b; --danger:#ef4444; --shadow:0 10px 25px rgba(0,0,0,.35);} *{box-sizing:border-box} html,body{height:100%} body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu; background:radial-gradient(1200px 700px at 10% -10%, rgba(79,140,255,.12), transparent), radial-gradient(800px 500px at 120% 10%, rgba(34,211,238,.12), transparent), var(--bg); color:var(--fg)} a{color:var(--brand)} .wrap{min-height:100%; display:grid; grid-template-rows:auto 1fr auto}
    header{display:flex; gap:12px; align-items:center; justify-content:space-between; padding:14px 18px; position:sticky; top:0; backdrop-filter:saturate(160%) blur(8px); background:linear-gradient(to bottom, rgba(17,24,38,.85), rgba(17,24,38,.55)); border-bottom:1px solid rgba(255,255,255,.06); z-index:5}
    .logo{display:flex; gap:10px; align-items:center; font-weight:700}
    .logo .dot{width:10px;height:10px;border-radius:999px;background:conic-gradient(var(--brand),var(--brand-2)); box-shadow:0 0 12px rgba(79,140,255,.8)}
    .toolbar{display:flex; gap:8px; align-items:center; flex-wrap:wrap}
    .search{display:flex; align-items:center; gap:8px; background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.08); padding:8px 10px; border-radius:10px; min-width:260px}
    .search input{all:unset; color:var(--fg); width:220px}
    .search .clear{all:unset; cursor:pointer; padding:6px; border-radius:8px}
    .search .clear:hover{background:rgba(255,255,255,.08)}
    .accent{display:flex; gap:8px; align-items:center; background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.08); padding:6px 8px; border-radius:10px}
    .accent input{display:none}
    .accent label{display:flex; align-items:center; gap:6px; padding:6px 8px; border-radius:8px; cursor:pointer; color:var(--muted); border:1px solid transparent}
    .accent input:checked + label{color:var(--fg); background:rgba(79,140,255,.15); border-color:rgba(79,140,255,.35)}
    .flag{width:18px; height:12px; border-radius:2px; overflow:hidden; box-shadow:0 0 0 1px rgba(255,255,255,.2) inset}
    .flag.us{background:linear-gradient(#b22234 50%, #fff 50%), repeating-linear-gradient(#b22234, #b22234 7.7%, #fff 7.7%, #fff 15.4%)}
    .flag.uk{background:conic-gradient(#00247d 0 25%, #cf142b 0 50%, #fff 0 75%, #00247d 0 100%)}
    .stats{display:flex; gap:10px; align-items:center}
    .pill{font-size:12px; letter-spacing:.12em; padding:.25rem .5rem; border-radius:999px; background:rgba(255,255,255,.06); color:var(--muted); border:1px solid rgba(255,255,255,.08)}
    main{display:grid; place-items:center; padding:18px}
    .grid{display:grid; grid-template-columns:1fr; gap:18px; width:min(980px, 100%)}
    .progress{background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.08); border-radius:12px; padding:10px}
    .progress .bar{height:10px; background:linear-gradient(90deg, var(--brand), var(--brand-2)); width:0%; border-radius:999px; box-shadow:var(--shadow); transition:width .35s ease}
    .card{position:relative; perspective:1200px; height:360px}
    .flip{width:100%; height:100%; position:relative; transform-style:preserve-3d; transition:transform .6s cubic-bezier(.2,.8,.2,1)}
    .card.show-back .flip{transform:rotateY(180deg)}
    .face{position:absolute; inset:0; backface-visibility:hidden; border-radius:16px; background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02)); border:1px solid rgba(255,255,255,.08); box-shadow:var(--shadow); padding:18px}
    .back{transform:rotateY(180deg)}
    h2{margin:.1em 0 .2em; font-size:34px}
    .muted{color:var(--muted)}
    .actions{display:flex; gap:8px; align-items:center; flex-wrap:wrap}
    .btn{all:unset; display:inline-flex; align-items:center; gap:8px; padding:10px 12px; border-radius:12px; cursor:pointer; background:rgba(79,140,255,.12); color:#dbe7ff; border:1px solid rgba(79,140,255,.35)}
    .btn.secondary{background:rgba(255,255,255,.06); border-color:rgba(255,255,255,.12); color:var(--fg)}
    .btn.ghost{background:transparent; border-color:transparent; color:var(--muted)}
    .btn:hover{filter:brightness(1.08)}
    .kbd{font:600 12px/1 Inter; padding:4px 6px; border-radius:6px; background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.1)}
    footer{padding:18px; text-align:center; color:var(--muted)}
    @media (max-width:640px){ .card{height:420px} h2{font-size:28px} }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo"><span class="dot"></span> Verbo Ingl√©s</div>
      <div class="toolbar">
        <div class="search" role="search">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M21 21l-4.35-4.35" stroke="#9aa4b2" stroke-width="2" stroke-linecap="round"/><circle cx="11" cy="11" r="7" stroke="#9aa4b2" stroke-width="2"/></svg>
          <input id="q" placeholder="Buscar: base, pasado, participio o traducci√≥n‚Ä¶" />
          <button id="clear" class="clear" title="Limpiar b√∫squeda">‚úï</button>
        </div>
        <div class="accent" role="group" aria-label="Acento">
          <input type="radio" name="accent" id="acc-us" value="us" checked>
          <label for="acc-us"><span class="flag us"></span> US</label>
          <input type="radio" name="accent" id="acc-uk" value="uk">
          <label for="acc-uk"><span class="flag uk"></span> UK</label>
        </div>
        <div class="stats">
          <span class="pill">Estudiados <span id="studied">0</span>/<span id="total">0</span></span>
          <span class="pill">Progreso <span id="percent">0%</span></span>
        </div>
      </div>
    </header>

    <main>
      <div class="grid">
        <div class="progress" aria-label="Barra de progreso">
          <div id="bar" class="bar" style="width:0%"></div>
        </div>

        <section id="card" class="card" aria-live="polite">
          <div class="flip">
            <article id="front" class="face front"></article>
            <article id="back" class="face back"></article>
          </div>
        </section>

        <div class="actions">
          <button id="prev" class="btn" title="Anterior (‚Üê)">‚Üê Anterior</button>
          <button id="next" class="btn" title="Siguiente (‚Üí)">Siguiente ‚Üí</button>
          <button id="flip" class="btn secondary" title="Voltear (Espacio)">Voltear tarjeta</button>
          <button id="rand" class="btn secondary" title="Aleatorio (R)">Aleatorio</button>
          <button id="favBtn" class="btn" title="Marcar favorito (A)">‚≠ê Favorito</button>
          <button id="audioAll" class="btn ghost" title="Reproducir pronunciaciones">üîä Escuchar</button>
        </div>

        <details open>
          <summary class="pill">Ayuda e instrucciones</summary>
          <div class="muted">
            ‚Ä¢ Teclas: ‚Üê anterior, ‚Üí siguiente, Espacio voltea, R aleatorio, A favorito. <br>
            ‚Ä¢ Busca por verbo, significado, pasado o participio. <br>
            ‚Ä¢ Cambia el acento (US/UK) para IPA y audio. <br>
            ‚Ä¢ Progreso en tiempo real y barra visual. Favoritos se guardan localmente.
          </div>
        </details>
      </div>
    </main>

    <footer>Hecho con ‚ô• ‚Äî aprendizaje de verbos irregulares</footer>
  </div>

  <script>
    const verbs = [
      { base:'be', past:'was/were', part:'been', meaning:'ser/estar', ipa_us:'/biÀê/', ipa_uk:'/biÀê/', audio_us:'', audio_uk:'' },
      { base:'begin', past:'began', part:'begun', meaning:'empezar', ipa_us:'/b…™Àà…°…™n/', ipa_uk:'/b…™Àà…°…™n/', audio_us:'', audio_uk:'' }
    ];

    const state = { idx: 0, filtered: [...verbs], shown: [], favorites: new Set(JSON.parse(localStorage.getItem('vi:favs')||'[]')), audioHandles: [] };
    function saveFavs(){ localStorage.setItem('vi:favs', JSON.stringify([...state.favorites])); }
    function saveShown(){ localStorage.setItem('vi:shown', JSON.stringify(state.shown)); }

    const $ = sel => document.querySelector(sel);
    const front = $('#front'), back = $('#back'), bar = $('#bar'), studiedEl = $('#studied'), totalEl = $('#total'), percentEl = $('#percent'), card = $('#card'), favBtn = $('#favBtn');
    const currentList = ()=> state.filtered;
    const currentVerb = ()=> currentList()[state.idx];

    function updateProgress(){ const total=currentList().length; const studied=state.shown.length?state.shown.filter(Boolean).length:0; const pct= total? Math.round((studied/total)*100):0; totalEl.textContent=total; studiedEl.textContent=studied; percentEl.textContent=pct+'%'; bar.style.width=pct+'%'; }
    function speak(url){ const a=new Audio(url||''); a.play().catch(()=>{}); return a; }

    function renderCard(){ const v=currentVerb(); if(!v){ front.textContent='Sin resultados'; back.textContent=''; return; } const acc=document.querySelector('input[name="accent"]:checked').value; const ipa= acc==='us'? v.ipa_us: v.ipa_uk; const audio= acc==='us'? v.audio_us: v.audio_uk; front.innerHTML=`<div class="pill">INFINITIVE</div><h2>${v.base}</h2><div class="muted">${v.meaning}</div><button class="btn secondary" id="audioFront">üîä ${ipa}</button>`; back.innerHTML=`<div class="pill">VERB FORMS</div><div style="margin:.6em 0 1em"><div><strong>Past:</strong> ${v.past}</div><div><strong>Participle:</strong> ${v.part}</div></div><div class="muted">Traducci√≥n: ${v.meaning}</div><div class="actions" style="margin-top:10px"><button class="btn secondary" id="audioBack">üîä ${ipa}</button></div>`; $('#audioFront').onclick=()=>{ state.audioHandles.push(speak(audio)); }; const ab=$('#audioBack'); if(ab) ab.onclick=()=>{ state.audioHandles.push(speak(audio)); }; const key=v.base.toLowerCase(); favBtn.textContent = (state.favorites.has(key)?'‚≠ê Favorito':'‚òÜ Favorito'); }

    const flip=()=> card.classList.toggle('show-back');
    const next=()=>{ if(state.idx < currentList().length-1){ state.idx++; state.shown[state.idx]=true; saveShown(); renderCard(); updateProgress(); } };
    const prev=()=>{ if(state.idx > 0){ state.idx--; renderCard(); updateProgress(); } };
    const randomize=()=>{ if(currentList().length){ state.idx=Math.floor(Math.random()*currentList().length); state.shown[state.idx]=true; saveShown(); renderCard(); updateProgress(); } };

    $('#q').addEventListener('input', e=>{ const q=e.target.value.trim().toLowerCase(); state.filtered = q? verbs.filter(v=> [v.base,v.past,v.part,v.meaning].some(x=>(x||'').toLowerCase().includes(q))) : [...verbs]; state.idx=0; renderCard(); updateProgress(); });
    $('#clear').onclick=()=>{ $('#q').value=''; $('#q').dispatchEvent(new Event('input')); };
    document.querySelectorAll('input[name="accent"]').forEach(r=> r.addEventListener('change', ()=> renderCard()));

    $('#prev').onclick=prev; $('#next').onclick=next; $('#flip').onclick=flip; $('#rand').onclick=randomize;
    favBtn.onclick=()=>{ const v=currentVerb(); if(!v) return; const key=v.base.toLowerCase(); if(state.favorites.has(key)) state.favorites.delete(key); else state.favorites.add(key); saveFavs(); renderCard(); };
    $('#audioAll').onclick=()=>{ const v=currentVerb(); if(!v) return; const acc=document.querySelector('input[name="accent"]:checked').value; const urls=[acc==='us'?v.audio_us:v.audio_uk]; urls.forEach(u=> state.audioHandles.push(speak(u))); };

    window.addEventListener('keydown', e=>{ if(e.target && ['INPUT','TEXTAREA'].includes(e.target.tagName)) return; if(e.code==='ArrowLeft'){ e.preventDefault(); prev(); } else if(e.code==='ArrowRight'){ e.preventDefault(); next(); } else if(e.code==='Space'){ e.preventDefault(); flip(); } else if(e.key==='r' || e.key==='R'){ randomize(); } else if(e.key==='a' || e.key==='A'){ favBtn.click(); } });

    // Inicializaci√≥n
    state.shown = JSON.parse(localStorage.getItem('vi:shown')||'[]');
    renderCard(); updateProgress();
  </script>
</body>
</html>
